<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Al Rey Villagracia | Portfolio</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { font-family: 'Segoe UI', sans-serif; margin: 0; padding: 40px; background: #f4f7fb; color: #333; }
    h1, h2 { color: #2c3e50; }
    h2 { border-bottom: 2px solid #3498db; padding-bottom: 5px; margin-top: 32px; }

    /* Top right nav (external) */
    nav.top {
      position: fixed; top: 0; right: 0; background: #fff; padding: 10px 20px;
      border-bottom-left-radius: 10px; box-shadow: -2px 2px 10px rgba(0,0,0,0.1); z-index: 1000;
    }
    nav.top a { margin-left: 20px; text-decoration: none; color: #3498db; font-weight: 600; font-size: 14px; }
    nav.top a:hover { text-decoration: underline; }

    /* Tabs */
    .tabs { display: flex; gap: 10px; margin: 10px 0 20px 0; flex-wrap: wrap; }
    .tab-btn {
      appearance: none; border: 1px solid #d0d7de; background: #fff; color: #2c3e50;
      padding: 10px 14px; border-radius: 10px; cursor: pointer; font-weight: 600;
      box-shadow: 0 1px 2px rgba(0,0,0,0.04);
    }
    .tab-btn.active { background: #2980b9; color: #fff; border-color: #2980b9; }
    .tab-panel { display: none; }
    .tab-panel.active { display: block; }

    /* Tables & lists (preserved) */
    table {
      width: 100%; border-collapse: collapse; margin-top: 30px; background: #fff;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05); font-size: 14px;
    }
    th, td { padding: 12px 15px; text-align: left; border: 1px solid #e0e0e0; }
    th { background-color: #2980b9; color: #ffffff; }
    tr:nth-child(even) { background-color: #f8f9fa; }
    tr:hover { background-color: #eaf2f8; }

    ul { padding-left: 20px; }
    li { margin-bottom: 8px; }
    .tag { display: inline-block; padding: 2px 8px; margin-left: 6px; font-size: 11px; color: #fff;
           background: #6c757d; border-radius: 10px; vertical-align: middle; }
    .tag.new { background: #27ae60; }

    /* Mini spec list */
    ul.meta { margin: 6px 0 12px 18px; padding-left: 12px; color: #3d4f60; font-size: 13px; }
    ul.meta li { margin: 2px 0; }
    ul.meta em { color: #22313f; font-style: normal; font-weight: 600; }

    /* Certifications helpers */
    .cluster { margin: 18px 0; scroll-margin-top: 80px; }
    .cluster h3 { margin-bottom: 8px; }
    .badge {
      display: inline-block; font-size: 12px; padding: 2px 8px; border-radius: 999px; background: #e9f4ff; color: #1b4f72;
      border: 1px solid #cfe6ff; margin-left: 6px; vertical-align: middle;
    }
    .hint { font-size: 12px; color: #556; }

    .status {
      margin: 12px 0 8px; padding: 10px 12px; border-radius: 10px; display: inline-flex; gap: 10px; align-items: center;
      border: 1px solid #d0e6d9; background: #eefaf1; color: #1d5f2e; font-weight: 600;
    }
    .status.error { border-color: #f5c2c7; background: #fff1f2; color: #7f1d1d; }
    .status .dot { width: 10px; height: 10px; border-radius: 50%; background: #27ae60; }
    .status.error .dot { background: #e74c3c; }

    /* Legend chips */
    .legend { display: flex; flex-wrap: wrap; gap: 8px; margin: 12px 0 8px; }
    .chip {
      display: inline-flex; align-items: center; gap: 8px;
      padding: 6px 10px; border: 1px solid #d0d7de; background: #fff; border-radius: 999px;
      font-size: 13px; cursor: pointer; box-shadow: 0 1px 2px rgba(0,0,0,0.04);
    }
    .chip:hover { background: #f0f7ff; border-color: #b6d6ff; }
    .chip .count {
      display: inline-block; min-width: 20px; text-align: center; padding: 2px 6px; border-radius: 999px;
      background: #2980b9; color: #fff; font-weight: 700; font-size: 12px;
    }
    .chip.all { background: #2980b9; color: #fff; border-color: #2980b9; }
    .chip.all .count { background: rgba(255,255,255,0.2); }

    /* Search */
    .searchbar {
      margin: 8px 0 12px; display: flex; gap: 10px; align-items: center; flex-wrap: wrap;
    }
    .searchbar input[type="search"] {
      flex: 1 1 320px; padding: 10px 12px; border-radius: 10px; border: 1px solid #d0d7de; background: #fff;
      font-size: 14px;
    }
    .searchbar .clear {
      padding: 8px 12px; border-radius: 10px; border: 1px solid #d0d7de; background: #fff; cursor: pointer; font-weight: 600;
    }
    .searchbar .clear:hover { background: #f0f7ff; border-color: #b6d6ff; }

    .footer { font-size: 12px; color: #777; text-align: center; margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd; }
  </style>
</head>
<body>

  <!-- External links -->
  <nav class="top">
    <a href="./index.html" target="_blank" rel="noopener noreferrer">Personal Website</a>
    <a href="https://share.streamlit.io/user/villagraciaa" target="_blank" rel="noopener noreferrer">Streamlit Cloud Applications</a>
  </nav>

  <h1>My Project Portfolio</h1>
  <p><strong>By: Al Rey Villagracia</strong></p>

  <!-- Tabs -->
  <div class="tabs" role="tablist" aria-label="Portfolio Tabs">
    <button class="tab-btn active" role="tab" aria-selected="true" aria-controls="panel-portfolio" id="tab-portfolio">Projects</button>
    <button class="tab-btn" role="tab" aria-selected="false" aria-controls="panel-certs" id="tab-certs">Certifications</button>
  </div>

  <!-- ===== Projects Panel ===== -->
  <section id="panel-portfolio" class="tab-panel active" role="tabpanel" aria-labelledby="tab-portfolio">
    <!-- Keep your existing Projects HTML here (unchanged). -->
  </section>

  <!-- ===== Certifications Panel ===== -->
  <section id="panel-certs" class="tab-panel" role="tabpanel" aria-labelledby="tab-certs">
    <h2>Certifications</h2>

    <div id="status" class="status" hidden><span class="dot"></span><span class="msg"></span></div>

    <!-- Search -->
    <div class="searchbar">
      <input id="cert-search" type="search" placeholder="Filter by title or issuer…" aria-label="Filter certifications" />
      <button class="clear" id="clear-search" type="button">Clear</button>
    </div>

    <!-- Dynamic legend -->
    <div id="legend" class="legend" aria-label="Certification clusters"></div>

    <!-- Clustered output -->
    <div id="cert-output"></div>

    <h3>Badge Portfolios & Evidence</h3>
    <ul>
      <li><a href="https://www.credly.com/users/al-rey-villagracia.09a12ff4#badge-portfolio" target="_blank" rel="noopener noreferrer">Credly — Badge Portfolio</a></li>
      <li><a href="https://www.credly.com/badges/aad41dd4-7d02-4629-afaf-d81c8802a5e2" target="_blank" rel="noopener noreferrer">Credly Badge</a></li>
      <li><a href="https://www.credly.com/badges/45997d5b-95f5-4ce4-aa16-4af3fbbbd27c" target="_blank" rel="noopener noreferrer">Credly Badge</a></li>
      <li><a href="https://www.credly.com/badges/22a1fc2a-04fe-4767-8a69-080730e3c819" target="_blank" rel="noopener noreferrer">Credly Badge</a></li>
      <li><a href="https://badges.wes.org/Evidence?i=287ba744-1800-45e1-b407-65a2e4f5244c&type=ca" target="_blank" rel="noopener noreferrer">WES — Evidence</a></li>
      <li><a href="https://drive.google.com/file/d/1WUtWZotXT7r11-WNWQ1zGqrr38lvECVv/view?usp=drive_link" target="_blank" rel="noopener noreferrer">Coursera Certificates (PDF)</a></li>
    </ul>
    <p class="hint">Clusters: Data Science & Analytics, Machine Learning & AI, <strong>Prompt Engineering & GenAI Apps</strong>, <strong>BI & Dashboards</strong>, <strong>Product & Project Management</strong>, <strong>Cloud Platforms</strong>, <strong>DevOps & Infrastructure</strong>, <strong>Big Data & Spark</strong>, Finance & Quantitative Analysis, Other / Domain‑Specific. Titles are alphabetized; issuers shown in parentheses.</p>
  </section>

  <div class="footer">© 2025 Al Rey Villagracia</div>

  <script>
    /* ---------- Tabs ---------- */
    const tabs = Array.from(document.querySelectorAll('.tab-btn'));
    const panels = {
      portfolio: document.getElementById('panel-portfolio'),
      certs: document.getElementById('panel-certs')
    };
    function activateTab(target) {
      tabs.forEach(btn => {
        const isActive = btn.id === 'tab-' + target;
        btn.classList.toggle('active', isActive);
        btn.setAttribute('aria-selected', isActive ? 'true' : 'false');
      });
      Object.keys(panels).forEach(k => panels[k].classList.remove('active'));
      panels[target].classList.add('active');
      history.replaceState(null, '', '#' + target);
      window.scrollTo({ top: 0, behavior: 'instant' });
    }
    document.getElementById('tab-portfolio').addEventListener('click', () => activateTab('portfolio'));
    document.getElementById('tab-certs').addEventListener('click', () => activateTab('certs'));
    const initial = (location.hash || '#portfolio').replace('#', '');
    if (['portfolio','certs'].includes(initial)) activateTab(initial);

    /* ---------- CSV fetch & parse ---------- */
    async function loadCSV(path) {
      const res = await fetch(path, { cache: 'no-store' });
      if (!res.ok) throw new Error('Failed to load ' + path + ' (' + res.status + ')');
      return await res.text();
    }
    function parseCSV(text) {
      const rows = [];
      let i = 0, cur = '', inQuotes = false, row = [];
      while (i < text.length) {
        const c = text[i];
        if (c === '"') {
          if (inQuotes && text[i+1] === '"') { cur += '"'; i++; }
          else { inQuotes = !inQuotes; }
        } else if (c === ',' && !inQuotes) {
          row.push(cur.trim()); cur = '';
        } else if ((c === '\n' || c === '\r') && !inQuotes) {
          if (cur.length || row.length) { row.push(cur.trim()); rows.push(row); row = []; cur = ''; }
          if (c === '\r' && text[i+1] === '\n') i++; // CRLF
        } else { cur += c; }
        i++;
      }
      if (cur.length || row.length) { row.push(cur.trim()); rows.push(row); }
      return rows.filter(r => r.length && r.some(x => x !== ''));
    }
    function normalizeHeaders(hdrs) {
      return hdrs.map(h => (h || '').toString().trim().toLowerCase().replace(/\s+/g,' '));
    }
    function findCols(headers) {
      const h = normalizeHeaders(headers);
      const col = (regexArr) => {
        for (let idx=0; idx<h.length; idx++) if (regexArr.some(r => r.test(h[idx]))) return idx;
        return -1;
      };
      return {
        company: col([/company|issuer|provider|organization|org/i]),
        title: col([/title|name|course|cert/i]),
        link: col([/link|url|cert\s*links?|certificate/i]),
        desc: col([/description|summary|pdf/i]),
        category: col([/category|cluster|domain|track|group/i])
      };
    }
    function rowsToItems(rows) {
      if (!rows.length) return [];
      const headers = rows[0];
      const cols = findCols(headers);
      const items = [];
      for (let i=1; i<rows.length; i++) {
        const r = rows[i];
        const it = {
          provider: cols.company >= 0 ? r[cols.company] : '',
          title: cols.title >= 0 ? r[cols.title] : (r[0] || '').trim(),
          link: cols.link >= 0 ? r[cols.link] : '',
          description: cols.desc >= 0 ? r[cols.desc] : '',
          category: cols.category >= 0 ? r[cols.category] : ''
        };
        const hasAny = Object.values(it).some(v => (v || '').trim() !== '');
        if (hasAny) items.push(it);
      }
      return items;
    }

    /* ---------- Cluster logic ---------- */
    const ORDERED_CLUSTERS = [
      'Data Science & Analytics',
      'Machine Learning & AI',
      'Prompt Engineering & GenAI Apps',
      'BI & Dashboards',
      'Product & Project Management',
      'Cloud Platforms',
      'DevOps & Infrastructure',
      'Big Data & Spark',
      'Finance & Quantitative Analysis',
      'Other / Domain-Specific'
    ];
    function slugify(s) { return s.toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/(^-|-$)/g,''); }

    function normalizeCategory(cat, title, description) {
      const t = (title || '').toLowerCase();
      const d = (description || '').toLowerCase();
      const hay = (t + ' ' + d).replace(/\s+/g,' ');
      const c = (cat || '').trim();
      if (c) return c;

      const has = (arr) => arr.some(k => hay.includes(k));

      // Prompt & GenAI Apps
      if (has(['prompt','vertex ai','gemini','llm','chatbot','rag','generative ai','gpt']))
        return 'Prompt Engineering & GenAI Apps';

      // ML & AI (general)
      if (has(['machine learning','deep learning','neural','artificial intelligence','nlp','transformer','pytorch','keras','tensorflow','scikit-learn','auc','roc','unsupervised','supervised']))
        return 'Machine Learning & AI';

      // Data Science & Analytics
      if (has(['data analysis','data analyst','statistics','pandas','excel','visualization','plotly','ab testing','a/b testing','powerquery','rdbms','sql','feature engineering']))
        return 'Data Science & Analytics';

      // BI & Dashboards
      if (has(['power bi','business intelligence','tableau','looker','dashboard','excel dashboard']))
        return 'BI & Dashboards';

      // Product & Project Management
      if (has(['project management','pmp','scrum','kanban','agile','content marketing','sales operations','proposal']))
        return 'Product & Project Management';

      // Cloud Platforms
      if (has(['azure','aws','gcp','google cloud','cloud computing','virtual machine','vm','hyper-v','vertex ai studio']))
        return 'Cloud Platforms';

      // DevOps & Infrastructure
      if (has(['kubernetes','docker','devops','jenkins','ci/cd','cicd','github actions','infrastructure as code','iac','scaling applications']))
        return 'DevOps & Infrastructure';

      // Big Data & Spark
      if (has(['spark','pyspark','big data','mllib']))
        return 'Big Data & Spark';

      // Finance
      if (has(['finance','accounting','financial','portfolio','budget','bookkeep','quickbooks','cpa','statement']))
        return 'Finance & Quantitative Analysis';

      return 'Other / Domain-Specific';
    }

    function groupAlphabetize(items) {
      const map = new Map();
      items.forEach(it => {
        const key = normalizeCategory(it.category, it.title, it.description);
        if (!map.has(key)) map.set(key, []);
        map.get(key).push(it);
      });
      for (const [k, arr] of map.entries()) {
        arr.sort((a, b) => (a.title || '').localeCompare(b.title || ''));
      }
      const known = ORDERED_CLUSTERS.filter(name => map.has(name));
      const extras = Array.from(map.keys()).filter(k => !ORDERED_CLUSTERS.includes(k)).sort();
      return { map, ordered: [...known, ...extras] };
    }

    /* ---------- Rendering ---------- */
    let ALL_ITEMS = [];  // raw items from CSV
    const EXPECTED_COUNT = 52;

    function setStatus(loadedCount, shownCount, errorMsg='') {
      const box = document.getElementById('status');
      const msg = box.querySelector('.msg');
      box.hidden = false;

      const loadedOK = loadedCount === EXPECTED_COUNT;
      box.classList.toggle('error', !loadedOK || !!errorMsg);

      if (errorMsg) {
        msg.textContent = errorMsg;
        return;
      }

      const base = loadedOK
        ? `Loaded ${loadedCount} certifications (✓ all ${EXPECTED_COUNT} present)`
        : `Loaded ${loadedCount} certifications — expected ${EXPECTED_COUNT}`;

      msg.textContent = (shownCount !== loadedCount)
        ? `${base} · Showing ${shownCount} after filter`
        : base;
    }

    function renderLegend(ordered, map) {
      const legend = document.getElementById('legend');
      legend.innerHTML = '';
      const total = Array.from(map.values()).reduce((n, arr) => n + arr.length, 0);

      // All chip
      const allChip = document.createElement('button');
      allChip.className = 'chip all';
      allChip.innerHTML = `<span>All</span><span class="count">${total}</span>`;
      allChip.onclick = () => window.scrollTo({ top: document.getElementById('cert-output').offsetTop - 20, behavior: 'smooth' });
      legend.appendChild(allChip);

      // Per-cluster chips
      ordered.forEach(cluster => {
        const count = (map.get(cluster) || []).length;
        const chip = document.createElement('button');
        chip.className = 'chip';
        chip.innerHTML = `<span>${cluster}</span><span class="count">${count}</span>`;
        chip.onclick = () => {
          const id = 'cluster-' + slugify(cluster);
          const el = document.getElementById(id);
          if (el) el.scrollIntoView({ behavior: 'smooth' });
        };
        legend.appendChild(chip);
      });
    }

    function renderCerts(items) {
      const out = document.getElementById('cert-output');
      out.innerHTML = '';

      const { map, ordered } = groupAlphabetize(items);
      renderLegend(ordered, map);

      ordered.forEach(cluster => {
        const list = map.get(cluster);
        if (!list || !list.length) return;
        const wrap = document.createElement('div');
        wrap.className = 'cluster';
        wrap.id = 'cluster-' + slugify(cluster);
        const badge = `<span class="badge">${list.length}</span>`;
        wrap.innerHTML = `<h3>${cluster} ${badge}</h3>`;
        const ul = document.createElement('ul');
        list.forEach(it => {
          const li = document.createElement('li');
          const provTxt = it.provider ? ` (${it.provider})` : '';
          const link = (it.link || '').trim();
          li.innerHTML = link && /^https?:\/\//i.test(link)
            ? `<a href="${link}" target="_blank" rel="noopener noreferrer">${it.title || '(Untitled)'}</a>${provTxt}`
            : `${it.title || '(Untitled)'}${provTxt}`;
          ul.appendChild(li);
        });
        wrap.appendChild(ul);
        out.appendChild(wrap);
      });
    }

    /* ---------- Search ---------- */
    function applyFilter(query) {
      const q = (query || '').toLowerCase().trim();
      if (!q) return ALL_ITEMS.slice();

      return ALL_ITEMS.filter(it => {
        const t = (it.title || '').toLowerCase();
        const p = (it.provider || '').toLowerCase();
        return t.includes(q) || p.includes(q);
      });
    }
    function debounce(fn, delay=200) {
      let to = null;
      return (...args) => {
        clearTimeout(to);
        to = setTimeout(() => fn(...args), delay);
      };
    }

    const onSearch = debounce(() => {
      const loadedCount = ALL_ITEMS.length;
      const q = document.getElementById('cert-search').value;
      const filtered = applyFilter(q);
      setStatus(loadedCount, filtered.length);
      renderCerts(filtered);
    }, 150);

    /* ---------- Boot ---------- */
    (async function init() {
      try {
        const text = await loadCSV('CourseraCerts.csv');
        const rows = parseCSV(text);
        ALL_ITEMS = rowsToItems(rows);

        // Initial render (unfiltered)
        setStatus(ALL_ITEMS.length, ALL_ITEMS.length);
        renderCerts(ALL_ITEMS);

        // Wire search events
        document.getElementById('cert-search').addEventListener('input', onSearch);
        document.getElementById('clear-search').addEventListener('click', () => {
          const inp = document.getElementById('cert-search');
          inp.value = '';
          setStatus(ALL_ITEMS.length, ALL_ITEMS.length);
          renderCerts(ALL_ITEMS);
          inp.focus();
        });

      } catch (err) {
        setStatus(0, 0, 'Could not read CourseraCerts.csv from this folder. Serve the page via a local server or check the filename.');
        console.error(err);
      }
    })();
  </script>
</body>
</html>
